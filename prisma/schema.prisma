generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model connections {
  id        Int       @id @default(autoincrement())
  ip        String?   @db.VarChar
  login     String?   @db.VarChar
  password  String?   @db.VarChar
  note      String?   @db.VarChar
  createdBy String    @db.VarChar
  createdAt DateTime  @default(now()) @db.Timestamptz
  updatedBy String?   @db.VarChar
  updatedAt DateTime? @updatedAt @db.Timestamptz
}

model users {
  id        Int       @id @default(autoincrement())
  active    Boolean   @default(true)
  password  String    @db.VarChar
  username  String    @unique @db.VarChar
  name      String?   @db.VarChar
  email     String    @unique @db.VarChar
  role      String    @db.VarChar
  createdBy String    @db.VarChar
  createdAt DateTime  @default(now()) @db.Timestamptz
  updatedBy String?   @db.VarChar
  updatedAt DateTime? @updatedAt @db.Timestamptz
}

model appliances {
  id            Int         @id @default(autoincrement())
  active        Boolean     @default(true)
  successor     appliances? @relation("ApplienceHistory")
  predecessorId Int?        @unique
  predecessor   appliances? @relation("ApplienceHistory", fields: [predecessorId], references: [id])
  customerId    Int?
  customer      customers?  @relation(fields: [customerId], references: [id])
  productId     Int?
  product       products?   @relation(fields: [productId], references: [id])
  dealerId      Int?
  dealer        dealers?    @relation(fields: [dealerId], references: [id])
  supplierId    Int?
  supplier      suppliers?  @relation(fields: [supplierId], references: [id])
  licenseId     Int?
  license       licenses?   @relation(fields: [licenseId], references: [id])
  serialNo      String?     @db.VarChar
  boughtAt      DateTime?   @db.Date
  soldAt        DateTime?   @db.Date
  createdBy     String      @db.VarChar
  createdAt     DateTime    @default(now()) @db.Timestamptz
  updatedBy     String?     @db.VarChar
  updatedAt     DateTime?   @updatedAt @db.Timestamptz
  isDeleted     Boolean     @default(false)
}

model licenses {
  id            Int          @id @default(autoincrement())
  active        Boolean      @default(true)
  successor     licenses?    @relation("LicenseHistory")
  predecessorId Int?         @unique
  predecessor   licenses?    @relation("LicenseHistory", fields: [predecessorId], references: [id])
  licenseTypeId Int
  licenseType   licenseTypes @relation(fields: [licenseTypeId], references: [id])
  dealerId      Int?
  dealer        dealers?     @relation(fields: [dealerId], references: [id])
  supplierId    Int?
  supplier      suppliers?   @relation(fields: [supplierId], references: [id])
  isStock       Boolean      @default(false)
  startDate     DateTime?    @db.Date
  expiryDate    DateTime?    @db.Date
  boughtType    String?      @db.VarChar
  boughtAt      DateTime?    @db.Date
  soldAt        DateTime?    @db.Date
  createdBy     String       @db.VarChar
  createdAt     DateTime     @default(now()) @db.Timestamptz
  updatedBy     String?      @db.VarChar
  updatedAt     DateTime?    @updatedAt @db.Timestamptz
  isDeleted     Boolean      @default(false)
  appliance     appliances[]
}

model products {
  id          Int            @id @default(autoincrement())
  active      Boolean        @default(true)
  brand       String         @db.VarChar
  model       String         @db.VarChar
  type        String?        @db.VarChar
  createdBy   String         @db.VarChar
  createdAt   DateTime       @default(now()) @db.Timestamptz
  updatedBy   String?        @db.VarChar
  updatedAt   DateTime?      @updatedAt @db.Timestamptz
  appliance   appliances[]
  licenseType licenseTypes[]
}

model licenseTypes {
  id        Int        @id @default(autoincrement())
  active    Boolean    @default(true)
  productId Int
  product   products   @relation(fields: [productId], references: [id])
  type      String     @db.VarChar
  duration  Int?
  price     Decimal?   @db.Decimal(9, 2)
  createdBy String     @db.VarChar
  createdAt DateTime   @default(now()) @db.Timestamptz
  updatedBy String?    @db.VarChar
  updatedAt DateTime?  @updatedAt @db.Timestamptz
  licenses  licenses[]
}

model customers {
  id        Int          @id @default(autoincrement())
  active    Boolean      @default(true)
  name      String       @db.VarChar
  phone     String?      @db.VarChar
  email     String?      @db.VarChar
  createdBy String       @db.VarChar
  createdAt DateTime     @default(now()) @db.Timestamptz
  updatedBy String?      @db.VarChar
  updatedAt DateTime?    @updatedAt @db.Timestamptz
  appliance appliances[]
}

model dealers {
  id        Int          @id @default(autoincrement())
  active    Boolean      @default(true)
  name      String       @db.VarChar
  phone     String?      @db.VarChar
  email     String?      @db.VarChar
  createdBy String       @db.VarChar
  createdAt DateTime     @default(now()) @db.Timestamptz
  updatedBy String?      @db.VarChar
  updatedAt DateTime?    @updatedAt @db.Timestamptz
  appliance appliances[]
  license   licenses[]
}

model suppliers {
  id        Int          @id @default(autoincrement())
  active    Boolean      @default(true)
  name      String       @db.VarChar
  phone     String?      @db.VarChar
  email     String?      @db.VarChar
  createdBy String       @db.VarChar
  createdAt DateTime     @default(now()) @db.Timestamptz
  updatedBy String?      @db.VarChar
  updatedAt DateTime?    @updatedAt @db.Timestamptz
  appliance appliances[]
  license   licenses[]
}
