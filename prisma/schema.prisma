generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model connections {
  id         Int        @id @default(autoincrement())
  login      String?    @db.VarChar
  password   String?    @db.VarChar
  note       String?    @db.VarChar
  createdAt  DateTime   @default(now()) @db.Timestamptz(6)
  createdBy  String     @db.VarChar
  updatedBy  String?    @db.VarChar
  ip         String?    @db.VarChar
  updatedAt  DateTime?  @updatedAt @db.Timestamptz(6)
  customerId Int?
  customer   customers? @relation(fields: [customerId], references: [id])
}

model users {
  id        Int       @id @default(autoincrement())
  username  String    @unique @db.VarChar
  name      String?   @db.VarChar
  email     String    @unique @db.VarChar
  password  String    @db.VarChar
  active    Boolean   @default(true)
  role      String    @db.VarChar
  createdAt DateTime  @default(now()) @db.Timestamptz(6)
  createdBy String    @db.VarChar
  updatedBy String?   @db.VarChar
  updatedAt DateTime? @updatedAt @db.Timestamptz(6)
}

model appliances {
  id            Int         @id @default(autoincrement())
  customerId    Int?
  productId     Int?
  active        Boolean     @default(true)
  createdAt     DateTime    @default(now()) @db.Timestamptz(6)
  createdBy     String      @db.VarChar
  dealerId      Int?
  serialNo      String?     @unique @db.VarChar
  supplierId    Int?
  updatedBy     String?     @db.VarChar
  boughtAt      DateTime?   @db.Date
  soldAt        DateTime?   @db.Date
  predecessorId Int?        @unique
  updatedAt     DateTime?   @updatedAt @db.Timestamptz(6)
  deleted       Boolean     @default(false)
  subDealerId   Int?
  customer      customers?  @relation(fields: [customerId], references: [id])
  dealer        dealers?    @relation("Dealer", fields: [dealerId], references: [id])
  predecessor   appliances? @relation("ApplienceHistory", fields: [predecessorId], references: [id])
  successor     appliances? @relation("ApplienceHistory")
  product       products?   @relation(fields: [productId], references: [id])
  subDealer     dealers?    @relation("SubDealer", fields: [subDealerId], references: [id])
  supplier      suppliers?  @relation(fields: [supplierId], references: [id])
  licenses      licenses[]
}

model licenses {
  id            Int          @id @default(autoincrement())
  active        Boolean      @default(true)
  isStock       Boolean      @default(false)
  startDate     DateTime?    @db.Date
  expiryDate    DateTime?    @db.Date
  createdBy     String       @db.VarChar
  createdAt     DateTime     @default(now()) @db.Timestamptz(6)
  updatedBy     String?      @db.VarChar
  boughtAt      DateTime?    @db.Date
  soldAt        DateTime?    @db.Date
  dealerId      Int?
  licenseTypeId Int
  supplierId    Int?
  updatedAt     DateTime?    @updatedAt @db.Timestamptz(6)
  customerId    Int?
  deleted       Boolean      @default(false)
  serialNo      String?      @unique @db.VarChar
  applianceId   Int?
  subDealerId   Int?
  boughtTypeId  Int?
  appliance     appliances?  @relation(fields: [applianceId], references: [id])
  boughtType    boughtTypes? @relation(fields: [boughtTypeId], references: [id])
  customer      customers?   @relation(fields: [customerId], references: [id])
  dealer        dealers?     @relation("Dealer", fields: [dealerId], references: [id])
  licenseType   licenseTypes @relation(fields: [licenseTypeId], references: [id])
  subDealer     dealers?     @relation("SubDealer", fields: [subDealerId], references: [id])
  supplier      suppliers?   @relation(fields: [supplierId], references: [id])
}

model products {
  id         Int          @id @default(autoincrement())
  active     Boolean      @default(true)
  brand      String       @db.VarChar
  type       String?      @db.VarChar
  createdAt  DateTime     @default(now()) @db.Timestamptz(6)
  createdBy  String       @db.VarChar
  model      String       @db.VarChar
  updatedBy  String?      @db.VarChar
  updatedAt  DateTime?    @updatedAt @db.Timestamptz(6)
  appliances appliances[]
}

model licenseTypes {
  id        Int        @id @default(autoincrement())
  active    Boolean    @default(true)
  duration  Int?
  type      String     @db.VarChar
  price     Decimal?   @db.Decimal(9, 2)
  createdAt DateTime   @default(now()) @db.Timestamptz(6)
  createdBy String     @db.VarChar
  updatedAt DateTime?  @updatedAt @db.Timestamptz(6)
  updatedBy String?    @db.VarChar
  brand     String?    @db.VarChar
  licenses  licenses[]
}

model boughtTypes {
  id        Int        @id @default(autoincrement())
  active    Boolean    @default(true)
  type      String     @db.VarChar
  createdAt DateTime   @default(now()) @db.Timestamptz(6)
  createdBy String     @db.VarChar
  updatedAt DateTime?  @updatedAt @db.Timestamptz(6)
  updatedBy String?    @db.VarChar
  licenses  licenses[]
}

model customers {
  id          Int           @id @default(autoincrement())
  active      Boolean       @default(true)
  name        String        @db.VarChar
  phone       String        @db.VarChar
  email       String        @db.VarChar
  createdAt   DateTime      @default(now()) @db.Timestamptz(6)
  createdBy   String        @db.VarChar
  updatedBy   String?       @db.VarChar
  updatedAt   DateTime?     @updatedAt @db.Timestamptz(6)
  appliances  appliances[]
  connections connections[]
  licenses    licenses[]
}

model dealers {
  id                  Int          @id @default(autoincrement())
  active              Boolean      @default(true)
  name                String       @db.VarChar
  createdBy           String       @db.VarChar
  createdAt           DateTime     @default(now()) @db.Timestamptz(6)
  updatedBy           String?      @db.VarChar
  email               String       @db.VarChar
  phone               String       @db.VarChar
  updatedAt           DateTime?    @updatedAt @db.Timestamptz(6)
  appliances          appliances[] @relation("Dealer")
  subDealerAppliances appliances[] @relation("SubDealer")
  licenses            licenses[]   @relation("Dealer")
  subDealerLicenses   licenses[]   @relation("SubDealer")
}

model suppliers {
  id         Int          @id @default(autoincrement())
  active     Boolean      @default(true)
  name       String       @db.VarChar
  createdBy  String       @db.VarChar
  createdAt  DateTime     @default(now()) @db.Timestamptz(6)
  updatedBy  String?      @db.VarChar
  email      String       @db.VarChar
  phone      String       @db.VarChar
  updatedAt  DateTime?    @updatedAt @db.Timestamptz(6)
  appliances appliances[]
  licenses   licenses[]
}

view vAppliances {
  id            Int       @unique
  serialNo      String?   @db.VarChar
  boughtAt      DateTime? @db.Date
  soldAt        DateTime? @db.Date
  createdBy     String?   @db.VarChar
  createdAt     DateTime? @db.Timestamptz(6)
  updatedBy     String?   @db.VarChar
  updatedAt     DateTime? @db.Timestamptz(6)
  deleted       Boolean?
  productId     Int?
  productModel  String?   @db.VarChar
  productBrand  String?   @db.VarChar
  customerName  String?   @db.VarChar
  dealerName    String?   @db.VarChar
  subDealerName String?   @db.VarChar
  supplierName  String?   @db.VarChar
}

view vLicenses {
  id                Int       @unique
  isStock           Boolean?
  serialNo          String?   @db.VarChar
  startDate         DateTime? @db.Date
  expiryDate        DateTime? @db.Date
  boughtAt          DateTime? @db.Date
  soldAt            DateTime? @db.Date
  createdBy         String?   @db.VarChar
  createdAt         DateTime? @db.Timestamptz(6)
  updatedBy         String?   @db.VarChar
  updatedAt         DateTime? @db.Timestamptz(6)
  deleted           Boolean?
  applianceSerialNo String?   @db.VarChar
  productModel      String?   @db.VarChar
  productBrand      String?   @db.VarChar
  licenseType       String?   @db.VarChar
  licenseDuration   Int?
  boughtType        String?   @db.VarChar
  customerName      String?   @db.VarChar
  dealerName        String?   @db.VarChar
  subDealerName     String?   @db.VarChar
  supplierName      String?   @db.VarChar
  expiryStatus      String?
}
